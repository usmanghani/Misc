
**************************************************
CLEAR
SET MESSAGE TO
CLOS ALL
SET CURSOR ON
SET SAFETY OFF
SET CONFIRM ON
SET STAT BAR ON
SET TALK OFF
ON ERROR DO ERRORHANDLER IN UTILITY
ON KEY LABEL ESCAPE DO GETOUT IN UTILITY
SET CENTURY ON
SET ESCAPE ON
SET DELETE OFF
SET DECIMAL TO 2
SET BELL TO 1000,1
DEAC WIND ALL
RELE WIND ALL
IF ISCOLOR()
DEFINE WINDOW WARIS AT 0,0 SIZE 30-2,125-2;
   SHADOW PANEL MINIMIZE FLOAT GROW;
   TITLE "** INFORMATION FORM THE USER **";
   FOOTER "DESIGNED BY: MUHAMMAD REHAN QADRI";
   FONT "MS SANS SERIF",8;
   COLOR RGB (,,255,192,192,192);
   FILL FILE SYS(5)+SYS(2003)+"\marb009.BMP"
ELSE
DEFINE WINDOW WARIS AT 0,0 SIZE 30-2,125-2;
   SHADOW PANEL MINIMIZE FLOAT GROW;
   TITLE "** INFORMATION FORM THE USER **";
   FOOTER "DESIGNED BY: MUHAMMAD REHAN QADRI";
   FONT "MS SANS SERIF",8;
   COLOR RGB (,,255,192,192,192)
ENDIF
ACTIVATE WINDOW WARIS
MOVE WINDOW WARIS CENTER
CLOSE DATABASES 
USE DETAIL IN 1 ALIAS DET
USE INHERIT IN 2 ALIAS INH
SELECT INH
SET ORDER TO TAG RECno
SELECT DET
SET RELATION TO RECno INTO INH
SELECT INH

SCATTER MEMVAR BLANK

*DO INPUT
*DO CALCULATE

*PROCEDURE INPUT
*BASIC INFORMATIONS:-

@ 1,24 SAY "BASIC INFORMATION ABOUT THE LATE " FONT "TIMES NEW ROMAN",16 STYLE "BTU" COLOR R*
@ 4.5,3 SAY "NAME OF THE LATE: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 7.5,3 SAY "DATE OF EXPIRE: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 7.5,80 SAY "SEX: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 11,40 SAY "VALUE OF INHERITANCE " FONT "TIMES NEW ROMAN",16 STYLE "BTU" COLOR R*
@ 13.5,3 SAY "IT INCLUDES: " FONT "TIMES NEW ROMAN",12 STYLE "BTU" COLOR G*
@ 16,3 SAY "1) CASH IN HAND" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 17.5,3 SAY "2) CASH IN BANK" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 19,3 SAY "3) MARKET VALUE OF PROPERTY" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 16,70 SAY "4) RECEIVABLE AMMOUNT" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 17.5,70 SAY "5) JEWELRY" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 19,70 SAY "6) OTHER" FONT "TIMES NEW ROMAN",12 STYLE "BT"
@ 23,3 SAY "TOTAL VALUE FOR INHERITANCE: " FONT "TIMES NEW ROMAN",14 STYLE "BT"

@ 4.5,60 GET M.NAME PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,30;
   VALID NOT EMPTY(M.NAME);
   ERROR "YOU CAN'T LEAVE FIELD EMPTY";
   MESSAGE "ENTER NAME OF THE LATE"

@ 7.5,40 GET M.DATE PICTURE "@!E";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,12;
   MESSAGE "ENTER NAME OF THE LATE"
@ 7.5,90 GET M.SEX PICTURE "@!" FUNCTION "M MALE,FEMALE";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,10;
   MESSAGE "PRESS SPACE BAR TO SELECT MALE OR FEMALE"
READ

@ 23,75 GET M.AMOUNT PICTURE "9999999999.99";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,15;
   VALID NOT EMPTY(M.AMOUNT);   
   MESSAGE "ENTER THE TOTAL VALUE FOR INHERITANCE"
READ

*INFORMATION ABOUT ASL:-
CLEAR
@ 1,5 SAY "INFORMATION ABOUT ASL OF THE LATE " FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 5,3 SAY "ASL INCLUDES: " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR GB
@ 9,3 SAY "1) FATHER " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 11.5,3 SAY "2) MOTHER " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 14,3 SAY "3) GRAND FATHER AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 16.5,3 SAY "4) GRAND MOTHER AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 20,3 SAY "IS THE LATE HAVE/HAS ASL (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNASL="Y"
@ 20,105 GET YNASL PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNASL)='Y' OR YNASL='N';
   SIZE 1,4
@ 23.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNASL="Y"
@ 20,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ELSE
YNASL="N"
YNFATHER="N"
YNGFATHER="N"
YNGMOTHER="N"
YNMOTHER="N"
@ 20,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ENDIF

IF YNASL="Y"

*INFORMATION ABOUT FATHER:-

CLEAR
@ 1,5 SAY "INFORMATION ABOUT FATHER OF THE LATE " FONT "TIMES NEW ROMAN",19 STYLE "BTU" COLOR R*
@ 10,3 SAY "IS THE LATE'S FATHER ALIVE ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNFATHER="Y"
@ 10,75 GET YNFATHER PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNFATHER)='Y' OR YNFATHER='N';
   SIZE 1,4
@ 14,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ   
IF YNFATHER="Y"
@ 10,75 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 18,3 SAY "NAME OF LATE'S FATHER: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
FATHER_NAME=SPACE(30)
@ 18,60 GET FATHER_NAME PICTURE "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,30;
   VALID NOT EMPTY(FATHER_NAME)   
READ
ELSE
@ 10,75 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNFATHER="N"
ENDIF

*INFORMATION OF GRAND FATHER:-

IF YNFATHER="N"
CLEAR
@ 2,5 SAY "INFORMATION ABOUT PATERNAL GRAND FATHER (DADA)" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,37 SAY "OF THE LATE (AT ANY LEVEL)" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 10,3 SAY "IS THE LATE'S PATERNAL GRAND FATHER (DADA) ALIVE ?: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
YNGFATHER="Y"
@ 10,115 GET YNGFATHER PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4;
   VALID (YNGFATHER)='Y' OR YNGFATHER='N'
   
@ 14,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ   
IF YNGFATHER="Y"
@ 10,115 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 18,3 SAY "NAME OF LATE'S PATERNAL GRAND FATHER (DADA): " FONT "TIMES NEW ROMAN",14 STYLE "BT"
GFATHER_NAME=SPACE(30)
@ 21,30 GET GFATHER_NAME PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(GFATHER_NAME);
   SIZE 1,30
READ
ELSE
@ 10,115 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNGFATHER="N"
ENDIF
ELSE
YNGFATHER="N"
ENDIF

*INFORMATION ABOUT MOTHER:-

CLEAR
@ 1,5 SAY "INFORMATION ABOUT MOTHER OF THE LATE " FONT "TIMES NEW ROMAN",19 STYLE "BTU" COLOR R*
@ 10,3 SAY "IS THE LATE'S MOTHER ALIVE ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNMOTHER="Y"
@ 10,75 GET YNMOTHER picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNMOTHER)='Y' OR YNMOTHER='N';
   SIZE 1,4
@ 14,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ   
IF YNMOTHER="Y"
@ 10,75 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 18,3 SAY "NAME OF LATE'S MOTHER: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
MOTHER_NAME=SPACE(30)
@ 18,60 GET MOTHER_NAME picture "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,30;
   VALID NOT EMPTY(MOTHER_NAME)   
READ
ELSE
@ 10,75 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNMOTHER="N"
ENDIF

*INFORMATION ABOUT GRAND MOTHERS:-

IF YNMOTHER="N"
CLEAR
@ 1,1.5 SAY "INFORMATION ABOUT NEAREST GRAND MOTHER(S) OF LATE" FONT "Times New Roman",14 STYLE "bTU" COLOR R*
@ 3.5,3 SAY "PATERNAL AND MATERNAL (DADI AND NANI) COMBINED " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR R*
@ 8,3 SAY "IS THE LATE'S GRAND MOTHER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNGMOTHER="Y"
@ 8,110 GET YNGMOTHER picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNGMOTHER)='Y' OR YNGMOTHER='N';
   SIZE 1,4
@ 10.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ   
IF YNGMOTHER="Y"
@ 8,110 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 12.5,1 SAY "IMPORTANT (Must Read This b/c Manual consideration is required) " FONT "Times new Roman",14 STYLE "BTU" COLOR r+
@ 14.5,1 SAY "1) Paternal Grand Mother(s) will be disable if Father of the late is alive. In this case Father = "+"("+upper(ynfather)+")." FONT "Times new Roman",12 STYLE "T" COLOR b
@ 16,1 SAY "2) Paternal Grand Mother(s) upper than Grand Father (First) will be disable if Grand Father of late is alive. But the wife of Grand Father (first) will not be disable. In this case Grand Father = "+"("+upper(yngfather)+")." FONT "Times new Roman",12 STYLE "T" COLOR b
@ 19,1 say "3) Farthest Grand Mother(s) will be disabled by Nearest Grand Mother(s)." FONT "Times new Roman",12 STYLE "T" COLOR b
@ 21,3 SAY "HOW MAY GRAND MOTHER(S) EXCLUDING DISABLES? " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 21,110 GET m.No_GMOTHER PICTURE "99";
   FONT "MS SANS SERIF",14 STYLE "B";
   VALID NOT M.NO_GMOTHER=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare GMOTHER_NAME(m.no_GMOTHER)
GMOTHER_name=space(30)
@ 6,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
r=14
for mGMOTHER=1 to m.no_GMOTHER
IF R>26
@ 14,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=14
ENDIF
@ r,3 SAY ALLTRIM(STR(MGMOTHER))+") NAME: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ r,62 GET GMOTHER_NAME[mGMOTHER] picture "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(GMOTHER_NAME[MGMOTHER]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+3
endfor
ELSE
@ 8,110 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNGMOTHER="N"
ENDIF
ELSE
YNGMOTHER="N"
ENDIF
ELSE
YNFATHER="N"
YNGFATHER="N"
YNGMOTHER="N"
YNMOTHER="N"
ENDIF

*INFORMATION ABOUT HUSBAND

IF M.SEX="FEMALE"
CLEAR
@ 1,5 SAY "INFORMATION ABOUT HUSBAND OF THE LATE " FONT "TIMES NEW ROMAN",19 STYLE "BTU" COLOR R*
@ 10,3 SAY "IS THE LATE'S HUSBAND ALIVE ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNHUSBAND="Y"
@ 10,75 GET YNHUSBAND PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNHUSBAND)='Y' OR YNHUSBAND='N';
   SIZE 1,4
@ 14,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ   
IF YNHUSBAND="Y"
@ 10,75 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 18,3 SAY "NAME OF LATE'S HUSBAND: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
HUSBAND_NAME=SPACE(30)
@ 18,62 GET HUSBAND_NAME PICTURE "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(HUSBAND_NAME);
   SIZE 1,30
READ
ELSE
@ 10,75 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNHUSBAND="N"
ENDIF
ELSE
YNHUSBAND="N"
ENDIF

*INFORMATION ABOUT WIFE

IF M.SEX="MALE"
CLEAR
@ 1,5 SAY "INFORMATION ABOUT WIFE OF THE LATE " FONT "TIMES NEW ROMAN",19 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS WIFE (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNWIFE="Y"
@ 5,100 GET YNWIFE PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNWIFE)='Y' OR YNWIFE='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNWIFE="Y"
@ 5,100 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY WIVES? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_wife PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_WIFE=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4;
   RANGE 1,4
READ   
declare WIFE_NAME(m.no_wife)
wife_name=space(30)
r=13
for mwife=1 to m.no_wife
@ r,3 SAY ALLTRIM(STR(MWIFE))+") NAME OF LATE'S WIFE: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ r,62 GET WIFE_NAME[mwife] PICTURE "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(WIFE_NAME[MWIFE]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+3
endfor
ELSE
@ 5,100 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNWIFE="N"
ENDIF
ELSE
YNWIFE="N"
ENDIF

*INFORMATION ABOUT FARA'A:-
CLEAR
@ 1,5 SAY "INFORMATION ABOUT FARAA'A OF THE LATE " FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 5,3 SAY "FARAA'A INCLUDES: " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR GB
@ 9,3 SAY "1) SONS " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 11.5,3 SAY "2) DAUGHTERS " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 14,3 SAY "3) GRAND SONS AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 16.5,3 SAY "4) GRAND DAUGHTERS AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 20,3 SAY "IS THE LATE HAVE/HAS FARAA'A (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNFARA="Y"
@ 20,105 GET YNFARA PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNFARA)='Y' OR YNFARA='N';
   SIZE 1,4
@ 23.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNFARA="Y"
@ 20,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ELSE
YNFARA="N"
YNSON="N"
YNGSON="N"
YNDAUGHT="N"
YNGDAUGHT="N"
@ 20,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ENDIF

IF YNFARA="Y"
*INFORMATION ABOUT DAUGHTER
CLEAR
@ 1,2.5 SAY "INFORMATION ABOUT DAUGHTERS OF THE LATE " FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS DAUGHTER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNDAUGHT="Y"
@ 5,105 GET YNDAUGHT PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNDAUGHT)='Y' OR YNDAUGHT='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNDAUGHT="Y"
@ 5,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY DAUGHTER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_DAUGHT PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_DAUGHT=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare DAUGHTER_NAME(m.no_DAUGHT)
DAUGHTER_name=space(30)
r=13
for mDAUGHT=1 to m.no_DAUGHT
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MDAUGHT))+") NAME OF LATE'S DAUGHTER: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,64 GET DAUGHTER_NAME[mDAUGHT] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(DAUGHTER_NAME[MDAUGHT]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNDAUGHT="N"
ENDIF

*INFORMATION ABOUT SON

CLEAR
@ 1,5.5 SAY "INFORMATION ABOUT SONS OF THE LATE " FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS SON(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNSON="Y"
@ 5,105 GET YNSON PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID YNSON='Y' OR YNSON='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNSON="Y"
@ 5,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY SON(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_SON PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_SON=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare SON_NAME(m.no_SON)
SON_name=space(30)
r=13
for mSON=1 to m.no_SON
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MSON))+") NAME OF LATE'S SON: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,58 GET SON_NAME[mSON] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(SON_NAME[MSON]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNSON="N"
ENDIF

*INFORMATION ABOUT GRAND SON

IF M.NO_SON=0
CLEAR
@ 1,1.5 SAY "INFORMATION ABOUT GRAND SONS OF THE LATE" FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 3,40.5 SAY "(AT ANY LEVEL) " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS GRAND SON(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNGSON="Y"
@ 5,105 GET YNGSON PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID YNGSON='Y' OR YNGSON='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNGSON="Y"
@ 5,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY GRAND SON(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_GSON PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_GSON=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare GSON_NAME(m.no_GSON)
GSON_name=space(30)
r=13
for mGSON=1 to m.no_GSON
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MGSON))+") NAME OF GRAND SON: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,58 GET GSON_NAME[mGSON] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(GSON_NAME[MGSON]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ENDIF
ELSE
M.NO_GSON=0
yngson="n"
ENDIF

* INFORMATION ABOUT GRAND DAUGHTERS

IF (m.no_daught<2 OR YNGSON="Y") AND YNSON="N"
CLEAR
@ 1,0.5 SAY "INFORMATION ABOUT GRAND DAUGHTERS OF THE LATE" FONT "TIMES NEW ROMAN",16 STYLE "BTU" COLOR R*
@ 3,40.5 SAY "(AT ANY LEVEL) " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS GRAND DAUGHTER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
YNGDAUGHT="Y"
@ 5,110 GET YNGDAUGHT PICTURE "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID YNGDAUGHT='Y' OR YNGDAUGHT='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNGDAUGHT="Y"
@ 5,110 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY GRAND DAUGHTER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_GDAUGHT PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_GDAUGHT=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare GDAUGHTER_NAME(m.no_GDAUGHT)
GDAUGHTER_name=space(30)
r=13
for mGDAUGHT=1 to m.no_GDAUGHT
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MGDAUGHT))+") NAME OF LATE'S GRAND DAUGHTER: " FONT "TIMES NEW ROMAN",13 STYLE "BT"
@ r,69 GET GDAUGHTER_NAME[mGDAUGHT] PICTURE "@!";
   FONT "MS SANS SERIF",13 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(GDAUGHTER_NAME[MGDAUGHT]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,110 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
ENDIF
ELSE
M.NO_GDAUGHT=0
yngdaught="n"
ENDIF

ENDIF

* INFORMATION ABOUT MATERNAL BROTHERS AND SISTERS

IF YNFARA="N" AND YNFATHER="N" AND YNGFATHER="N"
CLEAR
@ 1,2.5 SAY "INFORMATION ABOUT MATERNAL BROTHERS AND SISTERS" FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR R*
@ 3,12.5 SAY "(HAVING ONE SAME MOTHER) OF THE LATE " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR R*
@ 5.8,1 SAY "IS THE LATE HAVE/HAS MATERNAL BROTHER(S) AND SISTERS(S) ALIVE?: " FONT "TIMES NEW ROMAN",12 STYLE "BT"
YNMBRO="Y"
@ 5.8,115 GET YNMBRO picture "@!K";
   FONT "MS SANS SERIF",12 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID YNMBRO='Y' OR YNMBRO='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNMBRO="Y"
@ 5.8,115 SAY "YES" FONT "MS SANS SERIF",12 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY MATERNAL BROTHER(S) AND SISTER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,112 GET m.No_MBRO PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_MBRO=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare MBRO_NAME(m.no_MBRO)
MBRO_name=space(30)
r=13
for mMBRO=1 to m.no_MBRO
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MMBRO))+") NAME: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ r,60 GET MBRO_NAME[mMBRO] picture "@!";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(MBRO_NAME[MMBRO]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5.8,115 SAY "NO" FONT "MS SANS SERIF",12 STYLE "BT" COLOR N
YNMBRO="N"
ENDIF
ELSE
YNMBRO="N"
ENDIF

*INFORMATION ABOUT REAL SISTERS

IF YNSON="N" AND YNGSON="N" AND YNFATHER="N" AND YNGFATHER="N"
CLEAR
@ 1,0.5 SAY "INFORMATION ABOUT REAL SISTERS OF THE LATE " FONT "TIMES NEW ROMAN",18 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS SISTER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNSISTER="Y"
@ 5,105 GET YNSISTER picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNSISTER)='Y' OR YNSISTER='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNSISTER="Y"
@ 5,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY SISTER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_SISTER PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_SISTER=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare SISTER_NAME(m.no_SISTER)
SISTER_name=space(30)
r=13
for MSISTER=1 to m.no_SISTER
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MSISTER))+") NAME OF LATE'S SISTER: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,64 GET SISTER_NAME[MSISTER] picture "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(SISTER_NAME[MSISTER]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNSISTER="N"
ENDIF
ELSE
YNSISTER="N"
ENDIF

*INFORMATION ABOUT REAL BROTHER

IF YNSON="N" AND YNGSON="N" AND YNFATHER="N" AND YNGFATHER="N"
CLEAR
@ 1,4.5 SAY "INFORMATION ABOUT REAL BROTHERS OF THE LATE " FONT "TIMES NEW ROMAN",16 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE HAVE/HAS BROTHER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",16 STYLE "BT"
YNBROTHER="Y"
@ 5,105 GET YNBROTHER picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID YNBROTHER='Y' OR YNBROTHER='N';
   SIZE 1,4
@ 7.5,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNBROTHER="Y"
@ 5,105 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY BROTHER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,75 GET m.No_BROTHER PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_BROTHER=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare BROTHER_NAME(m.no_BROTHER)
BROTHER_name=space(30)
r=13
for mBROTHER=1 to m.no_BROTHER
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MBROTHER))+") NAME OF LATE'S BROTHER: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,62 GET BROTHER_NAME[mBROTHER] picture "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(BROTHER_NAME[MBROTHER]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,105 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNBROTHER="N"
ENDIF
ELSE
YNBROTHER="N"
ENDIF

*INFORMATION ABOUT PATERNAL BROTHERS

IF M.NO_SON=0 AND M.NO_GSON=0 AND YNFATHER="N" AND YNGFATHER="N" AND M.NO_BROTHER=0
CLEAR
@ 1,14.5 SAY "INFORMATION ABOUT PATERNAL BROTHERS " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 3,22 SAY "(HAVING SAME FATHER) OF THE LATE" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,0.5 SAY "IS THE LATE HAVE/HAS PATERNAL BROTHER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
YNPBRO="Y"
@ 5,110 GET YNPBRO picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNPBRO)='Y' OR YNPBRO='N';
   SIZE 1,4

@ 10,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNPBRO="Y"
@ 5,110 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 13,3 SAY "HOW MAY PATERNAL BROTHER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 13,90 GET m.No_PBRO PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_PBRO=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare PBRO_NAME(m.no_PBRO)
PBRO_name=space(30)
r=16
for MPBRO=1 to m.no_PBRO
IF R>26
@ 16,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=16
ENDIF
@ r,2 SAY ALLTRIM(STR(MPBRO))+") NAME OF LATE'S BROTHER: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,64 GET PBRO_NAME[MPBRO] picture "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(PBRO_NAME[MPBRO]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,110 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNPBRO="N"
ENDIF
ELSE
YNPBRO="N"
ENDIF

*INFORMATION ABOUT PATERNAL SISTERS

IF M.NO_SON=0 AND M.NO_GSON=0 AND YNFATHER="N" AND YNGFATHER="N" AND (M.NO_SISTER<2 OR M.NO_PBRO>0) AND M.NO_BROTHER=0
CLEAR
@ 1,14.5 SAY "INFORMATION ABOUT PATERNAL SISTERS " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 3,22 SAY "(HAVING SAME FATHER) OF THE LATE" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,0.5 SAY "IS THE LATE HAVE/HAS PATERNAL SISTER(S) (ALIVE) ?: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
YNPSISTER="Y"
@ 5,110 GET YNPSISTER picture "@!K";
   FONT "MS SANS SERIF",16 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNPSISTER)='Y' OR YNPSISTER='N';
   SIZE 1,4

@ 10,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNPSISTER="Y"
@ 5,110 SAY "YES" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
@ 13,3 SAY "HOW MAY PATERNAL SISTER(S)? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 13,90 GET m.No_PSISTER PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_PSISTER=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare PSISTER_NAME(m.no_PSISTER)
PSISTER_name=space(30)
r=16
for MPSISTER=1 to m.no_PSISTER
IF R>26
@ 16,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=16
ENDIF
@ r,2 SAY ALLTRIM(STR(MPSISTER))+") NAME OF LATE'S SISTER: " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,64 GET PSISTER_NAME[MPSISTER] picture "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(PSISTER_NAME[MPSISTER]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor
ELSE
@ 5,110 SAY "NO" FONT "MS SANS SERIF",16 STYLE "BT" COLOR N
YNPSISTER="N"
ENDIF
ELSE
YNPSISTER="N"
ENDIF

APPEND BLANK
GATHER MEMVAR


SELECT DET
CALC MAX(RECNO) TO REC
IF REC=0
REC=1
ELSE
REC=REC+1
ENDIF

SELECT INH
REPLACE RECNO WITH REC

SELECT DET

*PROCEDURE CALCULATE

* CALCULATION FOR THE SHARE OF FATHER

IF YNFATHER="Y"

do case
* FIRST CONDITION
CASE (YNSON="Y" OR YNGSON="Y") AND YNFATHER="Y"
MSHARE="1/6"

* SECOND CONDITION
CASE (YNDAUGHT="Y" OR YNGDAUGHT="Y") AND YNFATHER="Y"
MSHARE="-1/6"

* THIRD CONDITION
CASE (YNFARA="N") AND YNFATHER="Y"
MSHARE="-1"
ENDCASE

APPEND BLANK
REPLACE NAME WITH FATHER_NAME
REPLACE RECNO WITH REC
REPLACE RELATION WITH "FATHER"
REPLACE SHARE_D WITH MSHARE

ENDIF

*CALCULATION FOR THE SHARE OF MOTHER


IF YNMOTHER="Y"

DO CASE
CASE YNFARA="Y"
MSHARE="1/6"
WIFEHUSBAND="N"

CASE M.NO_MBRO+M.NO_SISTER+M.NO_BROTHER+M.NO_PSISTER+M.NO_PBRO=>2
MSHARE="1/6"
WIFEHUSBAND="N"

OTHERWISE
WIFEHUSBAND="Y"
MSHARE="1/3"

ENDCASE

*CASE (YNWIFE="Y" OR YNHUSBAND="Y") AND YNGFATHER="Y" AND YNFARA="N" AND YNMBRO="N" AND YNSISTER="N" AND YNBROTHER="N" AND YNPSISTER="N" AND YNPBRO="N"
*MSHARE="1/3"

*CASE (YNWIFE="Y" OR YNHUSBAND="Y") AND YNFATHER="Y" AND YNFARA="N" AND YNMBRO="N" AND YNSISTER="N" AND YNBROTHER="N" AND YNPSISTER="N" AND YNPBRO="N"
*MSHARE="01/3"


IF (YNWIFE="Y" OR YNHUSBAND="Y") AND YNGFATHER="Y" AND WIFEHUSBAND="Y"
MSHARE="1/3"
ENDIF

IF  (YNWIFE="Y" OR YNHUSBAND="Y") AND YNFATHER="Y" AND WIFEHUSBAND="Y"
MSHARE="01/3"
ENDIF

APPEND BLANK
REPLACE NAME WITH MOTHER_NAME
REPLACE RECNO WITH REC
REPLACE RELATION WITH "MOTHER"
REPLACE SHARE_D WITH MSHARE

ENDIF

*CALCULATION FOR THE SHARE OF GRAND FATHER

IF YNFATHER="N" AND YNGFATHER="Y"

do case

* FIRST CONDITION
CASE (YNSON="Y" OR YNGSON="Y") AND YNGFATHER="Y"
MSHARE="1/6"

* SECOND CONDITION											&& ASBA
CASE (YNDAUGHT="Y" OR YNGDAUGHT="Y") AND YNGFATHER="Y"
MSHARE="-1/6"

* THIRD CONDITION											&& ASBA
CASE YNFARA="N" AND YNGFATHER="Y"
MSHARE="-1"
ENDCASE

APPEND BLANK
REPLACE NAME WITH GFATHER_NAME
REPLACE RECNO WITH REC
REPLACE RELATION WITH "GRAND FATHER"
REPLACE SHARE_D WITH MSHARE

ENDIF


*CALCULATION FOR THE SHARE OF GRAND MOTHER

IF YNGMOTHER="Y"
MSHARE="1/6"
FOR LOOPING=1 TO (MGMOTHER-1)
APPEND BLANK
REPLACE NAME WITH GMOTHER_NAME[LOOPING]
REPLACE RELATION WITH "GRAND MOTHER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR
ENDIF


*CALCULATION FOR THE SHARE OF HUSBAND

IF M.SEX="FEMALE" AND YNHUSBAND="Y"

DO CASE

*FIRST CONDITION

CASE M.SEX="FEMALE" AND YNSON="N" AND YNGSON="N" AND YNDAUGHT="N" AND YNGDAUGHT="N"
MSHARE="1/2"

*SECOND CONDITION

CASE M.SEX="FEMALE" AND (YNSON="Y" OR YNGSON="Y" OR YNDAUGHT="Y" OR YNGDAUGHT="Y")
MSHARE="1/4"

ENDCASE

APPEND BLANK
REPLACE NAME WITH HUSBAND_NAME
REPLACE RELATION WITH "HUSBAND"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC

ENDIF

*CALCULATION FOR THE SHARE OF WIVES


IF M.SEX="MALE" AND YNWIFE="Y"

DO CASE

*FIRST CONDITION

CASE M.SEX="MALE" AND YNSON="N" AND YNGSON="N" AND YNDAUGHT="N" AND YNGDAUGHT="N"
MSHARE="1/4"

*SECOND CONDITION

CASE M.SEX="MALE" AND (YNSON="Y" OR YNGSON="Y" OR YNDAUGHT="Y" OR YNGDAUGHT="Y")
MSHARE="1/8"


ENDCASE

FOR LOOPING=1 TO (MWIFE-1)
APPEND BLANK
REPLACE NAME WITH WIFE_NAME[LOOPING]
REPLACE RELATION WITH "WIFE"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF


*CALCULATION FOR THE SHARE OF REAL DAUGHTERS

IF YNDAUGHT="Y"

DO CASE
*FIRST CONDITION

CASE M.NO_DAUGHT=1 AND YNSON="N"
MSHARE="1/2"

*SECOND CONDITION

CASE M.NO_DAUGHT>1 AND YNSON="N"
MSHARE="2/3"

*THIRD CONDITION

CASE YNDAUGHT="Y" AND YNSON="Y"											&& ASBA
MSHARE="-1"

ENDCASE

FOR LOOPING=1 TO (MDAUGHT-1)
APPEND BLANK
REPLACE NAME WITH DAUGHTER_NAME[LOOPING]
REPLACE RELATION WITH "DAUGHTER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF


*CALCULATION FOR THE SHARE OF REAL SONS

IF YNSON="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MSON-1)
APPEND BLANK
REPLACE NAME WITH SON_NAME[LOOPING]
REPLACE RELATION WITH "SON"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF GRAND DAUGHTERS

IF YNGDAUGHT="Y"

DO CASE
*FIRST CONDITION

CASE M.NO_DAUGHT=0 AND M.NO_SON=0 AND M.NO_GDAUGHT=1
MSHARE="1/2"

*SECOND CONDITION

CASE M.NO_DAUGHT=0 AND M.NO_SON=0 AND M.NO_GDAUGHT>1
MSHARE="2/3"

*THIRD CONDITION

CASE M.NO_DAUGHT=1
MSHARE="1/6"

*FOURTH CONDITION

CASE YNGSON="Y"
MSHARE="-1"

ENDCASE

FOR LOOPING=1 TO (MGDAUGHT-1)
APPEND BLANK
REPLACE NAME WITH GDAUGHTER_NAME[LOOPING]
REPLACE RELATION WITH "GRAND DAUGHTER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF GRAND SONS

IF YNGSON="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MGSON-1)
APPEND BLANK
REPLACE NAME WITH GSON_NAME[LOOPING]
REPLACE RELATION WITH "GRAND SON"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF REAL SISTERS

IF YNSISTER="Y"

DO CASE
*FIRST CONDITION

CASE M.NO_SISTER=1 AND YNBROTHER="N"
MSHARE="1/2"

*SECOND CONDITION

CASE M.NO_SISTER>1 AND YNBROTHER="N"
MSHARE="2/3"

*THIRD CONDITION

CASE YNSISTER="Y" AND YNBROTHER="Y"											&& ASBA
MSHARE="-1"

ENDCASE

*FOURTH CONDITION
IF YNSISTER="Y" AND (YNDAUGHT="Y" OR YNGDAUGHT="Y") AND YNBROTHER="N"
MSHARE="-1"
ENDIF

FOR LOOPING=1 TO (MSISTER-1)
APPEND BLANK
REPLACE NAME WITH SISTER_NAME[LOOPING]
REPLACE RELATION WITH "SISTER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF REAL BROTHERS

IF YNBROTHER="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MBROTHER-1)
APPEND BLANK
REPLACE NAME WITH BROTHER_NAME[LOOPING]
REPLACE RELATION WITH "BROTHER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF


*CALCULATION FOR THE SHARE OF MATERNAL BROTHERS AND SISTERS

IF YNMBRO="Y"

*FIRST CONDITION
DO CASE
CASE M.NO_MBRO=1
MSHARE="1/6"

CASE M.NO_MBRO>1
MSHARE="1/3"
ENDCASE

FOR LOOPING=1 TO (MMBRO-1)
APPEND BLANK
REPLACE NAME WITH MBRO_NAME[LOOPING]
REPLACE RELATION WITH "MATER. BRO/SIS"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF PATERNAL SISTERS

IF YNPSISTER="Y"

*FIRST CONDITION

IF M.NO_PSISTER=1 AND YNSISTER="N" AND YNPBRO="N"
MSHARE="1/2"
ENDIF

*SECOND CONDITION

IF M.NO_SISTER>1 AND YNSISTER="N" AND YNPBRO="N"
MSHARE="2/3"
ENDIF

*THIRD CONDITION
IF YNPSISTER="Y" AND M.NO_SISTER<2 AND YNPBRO="N"
MSHARE="1/6"
ENDIF

*FORTH CONDITION
IF YNPSISTER="Y" AND YNPBRO="Y"
MSHARE="-1"
ENDIF

*FIFTH CONDITION
IF YNSISTER="Y" AND (YNDAUGHT="Y" OR YNGDAUGHT="Y") AND YNBROTHER="N"
MSHARE="-1"
ENDIF

FOR LOOPING=1 TO (MPSISTER-1)
APPEND BLANK
REPLACE NAME WITH PSISTER_NAME[LOOPING]
REPLACE RELATION WITH "PATERNAL SISTER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*CALCULATION FOR THE SHARE OF PATERNAL BROTHERS

IF YNPBRO="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MPBRO-1)
APPEND BLANK
REPLACE NAME WITH PBRO_NAME[LOOPING]
REPLACE RELATION WITH "PATERNAL BROTHER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF


*INFORMATION ABOUT MASCULINE FARA OF BROTHER (ANY TYPE)
LOCATE FOR LEFT(SHARE_D,1)="-" AND RECNO=REC
IF NOT FOUND()
SELECT INH
CLEAR
@ 1,5.5 SAY "INFORMATION ABOUT NEAREST MASCULINE FARAA'A OF" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 3,40.5 SAY "BROTHER OF THE LATE " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 7,3 SAY "MASCULINE FARAA'A INCLUDES: " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR GB
@ 9,3 SAY "1) SONS " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 10.5,3 SAY "2) GRAND SONS AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 13,3 SAY "IMPORTANT (Must Read This b/c Manual consideration is required) " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR R+
@ 15,3 SAY "1) Information is required about nearest Fara'a. Therefore Son will disable Grand Son. " FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR b
@ 16.5,3 SAY "2) Fara'a of Real Brother will Disbale Fara'a of Paternal Brother." FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR b
@ 18,3 SAY "3) Maternal Brother will not be included in this category." FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR b
@ 21,3 SAY "IS THE LATE'S BROTHER HAVE/HAS MASCULINE FARAA'A (ALIVE) ?: " FONT "TIMES NEW ROMAN",13 STYLE "BT"
YNBFARA="Y"
@ 21,115 GET YNBFARA PICTURE "@!K";
   FONT "MS SANS SERIF",13 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNBFARA)='Y' OR YNBFARA='N';
   SIZE 1,4
@ 23,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNBFARA="Y"
@ 21,115 SAY "YES" FONT "MS SANS SERIF",13 STYLE "BT" COLOR N
@ 5,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
@ 10,3 SAY "HOW MAY NEAREST FARA'A EXCLUDING DISABLES? " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 10,110 GET m.No_FSON PICTURE "99";
   FONT "MS SANS SERIF",14 STYLE "B";
   VALID NOT M.NO_FSON=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare FSON_NAME(m.no_FSON)
FSON_name=space(30)
r=13
for mFSON=1 to m.no_FSON
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MFSON))+") NAME : " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,58 GET FSON_NAME[mFSON] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(FSON_NAME[MFSON]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor

ELSE
YNBFARA="N"
@ 21,115 SAY "NO" FONT "MS SANS SERIF",13 STYLE "BT" COLOR N
ENDIF
ELSE
YNBFARA="N"
ENDIF

SELECT DET

*CALCULATION FOR THE SHARE OF NEAREST FARA OF BROTHER OF LATE

IF YNBFARA="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MFSON-1)
APPEND BLANK
REPLACE NAME WITH FSON_NAME[LOOPING]
REPLACE RELATION WITH "FARA OF BROTHER"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*INFORMATION ABOUT REAL UNCLE
LOCATE FOR LEFT(SHARE_D,1)="-" AND RECNO=REC
IF NOT FOUND()
SELECT INH
CLEAR
@ 1,1.5 SAY "INFORMATION ABOUT REAL UNCLE OF THE LATE" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 5,3 SAY "IS THE LATE'S REAL UNCLE (ALIVE) ?: " FONT "TIMES NEW ROMAN",15 STYLE "BT"
YNUNCLE="Y"
@ 5,115 GET YNUNCLE PICTURE "@!K";
   FONT "MS SANS SERIF",15 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNUNCLE)='Y' OR YNUNCLE='N';
   SIZE 1,4
@ 7,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNUNCLE="Y"
@ 5,115 SAY "YES" FONT "MS SANS SERIF",15 STYLE "BT" COLOR N
@ 10,3 SAY "HOW MAY REAL UNCLES ? " FONT "TIMES NEW ROMAN",16 STYLE "BT"
@ 10,85 GET m.No_UNCLE PICTURE "99";
   FONT "MS SANS SERIF",16 STYLE "B";
   VALID NOT M.NO_UNCLE=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare UNCLE_NAME(m.no_UNCLE)
UNCLE_name=space(30)
r=13
for mUNCLE=1 to m.no_UNCLE
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MUNCLE))+") NAME : " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,58 GET UNCLE_NAME[mUNCLE] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(UNCLE_NAME[MUNCLE]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor

ELSE
YNUNCLE="N"
@ 5,115 SAY "NO" FONT "MS SANS SERIF",15 STYLE "BT" COLOR N
ENDIF
ELSE
YNUNCLE="N"
ENDIF

SELECT DET

*CALCULATION FOR THE SHARE OF REAL UNCLE OF LATE

IF YNUNCLE="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MUNCLE-1)
APPEND BLANK
REPLACE NAME WITH UNCLE_NAME[LOOPING]
REPLACE RELATION WITH "PATERNAL UNCLE"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

*INFORMATION ABOUT MASCULINE FARA OF PATERNAL UNCLE
LOCATE FOR LEFT(SHARE_D,1)="-" AND RECNO=REC
IF NOT FOUND()
SELECT INH
CLEAR
@ 1,5.5 SAY "INFORMATION ABOUT NEAREST MASCULINE FARAA'A OF" FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 3,40.5 SAY "PATERNAL UNCLE OF THE LATE " FONT "TIMES NEW ROMAN",15 STYLE "BTU" COLOR R*
@ 7,3 SAY "MASCULINE FARAA'A INCLUDES: " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR GB
@ 9,3 SAY "1) SONS " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 10.5,3 SAY "2) GRAND SONS AT ANY LEVEL " FONT "TIMES NEW ROMAN",14 STYLE "BT" COLOR B
@ 13,3 SAY "IMPORTANT (Must Read This b/c Manual consideration is required) " FONT "TIMES NEW ROMAN",14 STYLE "BTU" COLOR R+
@ 15,3 SAY "Information is required about nearest Fara'a. Therefore Son will disable Grand Son. " FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR b
@ 18,3 SAY "IS THE LATE'S PATERNAL UNCLE HAVE/HAS: " FONT "TIMES NEW ROMAN",15 STYLE "BT"
@ 21,3 SAY "MASCULINE FARAA'A (ALIVE) ?: " FONT "TIMES NEW ROMAN",15 STYLE "BT"
YNFUNCLE="Y"
@ 21,115 GET YNFUNCLE PICTURE "@!K";
   FONT "MS SANS SERIF",15 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID (YNFUNCLE)='Y' OR YNFUNCLE='N';
   SIZE 1,4
@ 23,25 SAY "PRESS Y FOR YES AND N FOR NO" FONT "TIMES NEW ROMAN",16 STYLE "BT" COLOR GB*
READ
IF YNFUNCLE="Y"
@ 21,115 SAY "YES" FONT "MS SANS SERIF",15 STYLE "BT" COLOR N
@ 5,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
@ 10,3 SAY "HOW MAY NEAREST FARA'A EXCLUDING DISABLES? " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ 10,110 GET m.No_FUNCLE PICTURE "99";
   FONT "MS SANS SERIF",14 STYLE "B";
   VALID NOT M.NO_FUNCLE=0;
   COLOR ,RGB(,,,255,255,255);
   SIZE 1,4
READ   
declare FUNCLE_NAME(m.no_FUNCLE)
FUNCLE_name=space(30)
r=13
for mFUNCLE=1 to m.no_FUNCLE
IF R>26
@ 13,0 TO WROWS("WARIS"),WCOLS("WARIS") CLEAR
R=13
ENDIF
@ r,2 SAY ALLTRIM(STR(MFUNCLE))+") NAME : " FONT "TIMES NEW ROMAN",14 STYLE "BT"
@ r,58 GET FUNCLE_NAME[mFUNCLE] PICTURE "@!";
   FONT "MS SANS SERIF",14 STYLE "B";
   COLOR ,RGB(,,,255,255,255);
   VALID NOT EMPTY(FUNCLE_NAME[MFUNCLE]);
   SIZE 1,30;
   ERROR "YOU CAN'T LEAVE THAT FIELD EMPTY"
READ
r=r+2.5
endfor

ELSE
YNFUNCLE="N"
@ 21,115 SAY "NO" FONT "MS SANS SERIF",15 STYLE "BT" COLOR N
ENDIF
ELSE
YNFUNCLE="N"
ENDIF

SELECT DET

*CALCULATION FOR THE SHARE OF NEAREST FARA OF PATERNAL UNCLE OF LATE

IF YNFUNCLE="Y"

*FIRST CONDITION
MSHARE="-2"

FOR LOOPING=1 TO (MFUNCLE-1)
APPEND BLANK
REPLACE NAME WITH FUNCLE_NAME[LOOPING]
REPLACE RELATION WITH "FARA OF PAT. UNCLE"
REPLACE SHARE_D WITH MSHARE
REPLACE RECNO WITH REC
ENDFOR

ENDIF

DO MAKHRAJ


PROCEDURE MAKHRAJ
VALUE=AMOUNT
SELECT DET
*FIRST CONDITION FOR MAKHRAJ=2
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(2,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
			 MAKHRAJ=2		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF     


IF MAKCHOICE=0
*SECOND CONDITION FOR MAKHRAJ=3
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(3,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
			 MAKHRAJ=3		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF     
ENDIF

IF MAKCHOICE=0
*THIRD CONDITION FOR MAKHRAJ=4
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(4,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
			 MAKHRAJ=4		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF     
ENDIF

IF MAKCHOICE=0
*FOURTH CONDITION FOR MAKHRAJ=6
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(6,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
			 MAKHRAJ=6		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF     
ENDIF

IF MAKCHOICE=0
*FIFTH CONDITION FOR MAKHRAJ=8
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(8,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
			 MAKHRAJ=8		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF     
ENDIF

IF MAKCHOICE=0
*SIXTH CONDITION FOR MAKHRAJ=12
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(12,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
		     MAKHRAJ=12		  
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF
ENDIF

IF MAKCHOICE=0
*SEVENTH CONDITION FOR MAKHRAJ=24
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
     DO WHILE RECNO=REC
          
          MODULUS=MOD(24,VAL(RIGHT(ALLTRIM(SHARE_D),1)))
		  IF MODULUS=0
		     MAKCHOICE=1
		     MAKHRAJ=24
		  ELSE
		     MAKCHOICE=0
		     EXIT
		  ENDIF
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
     ENDDO
ENDIF
ENDIF


TOTAL=0
GOTO TOP
LOCATE FOR RECNO=REC
IF FOUND()
CHECK=1
     DO WHILE RECNO=REC
		IF LEFT(SHARE_D,1)="-" AND NOT SUBSTR(SHARE_D,3,1)="/"
		MSHARE=0
		ELSE
		MSHARE=ABS(VAL(SHARE_D))*MAKHRAJ/VAL(RIGHT(ALLTRIM(SHARE_D),1))
	    ENDIF
	    REPLACE SHARE WITH MSHARE
		  IF CHECK=1
		     TOTAL=TOTAL+MSHARE  
		  ENDIF
		  IF NOT EOF()
		     MRELATION=RELATION
		     CONTINUE
     	     NRELATION=RELATION
				IF MRELATION=NRELATION
				    CHECK=0
				ELSE
					CHECK=1
				ENDIF     	  
     	  ENDIF
	 ENDDO
ENDIF


*PROCEDURE OF O'OL:

if total>makhraj
SELECT INH
LOCATE FOR RECNO=REC
REPLACE MAK_TYPE WITH "O'OL"
SELECT DET
Makhraj=total
endif

IF TOTAL<MAKHRAJ
LOCATE FOR LEFT(SHARE_D,1)="-" AND RECNO=REC
IF .NOT. FOUND()
DO RAD
SELECT INH
LOCATE FOR RECNO=REC
REPLACE MAK_TYPE WITH "RUD"
SELECT DET
ENDIF
ENDIF
GOTO TOP
LOCATE FOR RECNO=REC AND NOT LEFT(SHARE_D,1)="-" AND NOT LEFT(SHARE_D,1)="0"
IF FOUND()
     DO WHILE RECNO=REC
		DO CASE
			CASE RELATION="WIFE"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_WIFE
			CASE RELATION="DAUGHTER"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_DAUGHT
			CASE RELATION="GRAND DAUGHTER"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_GDAUGHT
			CASE RELATION="MATER. BRO/SIS"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_MBRO
			CASE RELATION="SISTER"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_SISTER
			CASE RELATION="PATERNAL SISTER"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_PSISTER
			CASE RELATION="GRAND MOTHER"
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)/INH.NO_GMOTHER
			
			OTHERWISE
				MAMMOUNT=((VALUE/MAKHRAJ)*SHARE)
	    	ENDCASE
	  REPLACE AMMOUNT WITH MAMMOUNT
		  IF NOT EOF()
		     CONTINUE
     	  ENDIF
	 ENDDO
ENDIF


*CALCULATION FOR ASBA:-
CALC SUM(AMMOUNT) FOR RECNO=REC TO ASBA
LOCATE FOR RECNO=REC
NETASBA=VALUE-ASBA

LOCATE FOR RELATION="MOTHER" AND SHARE_D="01/3" AND RECNO=REC

IF FOUND()
REPLACE AMMOUNT WITH (NETASBA/3)
NETASBA=(NETASBA-(NETASBA/3))
ENDIF

IF NETASBA=>0.1
COUNT=0
	LOCATE FOR LEFT(SHARE_D,1)="-" AND RECNO=REC
		IF FOUND()
			COUNT=COUNT+ABS(VAL(SHARE_D))
		ENDIF
		DO WHILE NOT EOF()
			CONTINUE
			COUNT=COUNT+ABS(VAL(SHARE_D))
		ENDDO
NETASBA=NETASBA/COUNT
ENDIF

REPLACE AMMOUNT WITH AMMOUNT+(NETASBA*ABS(VAL(SHARE_D))) FOR RECNO=REC AND LEFT(SHARE_D,1)="-"
*REPLACE SHARE WITH AMMOUNT/(VALUE/MAKHRAJ) FOR (SHARE=0 OR LEFT(SHARE_D,3)="-1/") AND RECNO=REC ALL
REPLACE SHARE WITH AMMOUNT/(VALUE/MAKHRAJ) FOR RECNO=REC ALL
SELECT INH
LOCATE FOR RECNO=REC
IF FOUND()
IF MAK_TYPE<>"RUD" AND MAK_TYPE<>"O'OL"
REPLACE MAK_TYPE WITH "NORMAL"
ENDIF
REPLACE MASALA WITH MAKHRAJ FOR RECNO=REC ALL
CLEAR
@ 0,5 SAY "REC# :" FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR B+
@ 0,15 SAY REC FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR G*
@ 0,30 SAY "NAME OF THE LATE :" FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR B+
@ 0,65 SAY M.NAME FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR G*
@ 1.5,5 SAY "AMMOUNT: " FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR B+
@ 1.5,25 SAY M.AMOUNT FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR G*
@ 1.5,45 SAY "MAKHRAJ: " FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR B+
@ 1.5,65 SAY MAKHRAJ FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR G*
@ 1.5,80 SAY "EXPIRATION: " FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR B+
@ 1.5,106 SAY M.DATE FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR G*
@ 4.5,0 SAY PADC( "EXTRACTION TYPE:",WCOLS("WARIS")-10 ) FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
LOCATE FOR RECNO=REC
@ 4.5,0 SAY PADC( INH.MAK_TYPE,WCOLS("WARIS")+70 ) FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
ENDIF
@ 3,5 SAY "EXTRACTION VALUE:" FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
@ 3,35 SAY VALUE/MAKHRAJ FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
SELECT DET
CALC SUM(AMMOUNT) FOR RECNO=REC TO DIFF
DIFF=VALUE-DIFF
@ 3,75 SAY "DIFFERENCE:" FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
@ 3,95 SAY DIFF FONT "TIMES NEW ROMAN",12 STYLE "BT" COLOR R+
DEFINE WINDOW WARIS1 IN WINDOW WARIS AT 6,0 SIZE 30-10,125-4;
   SHADOW MINIMIZE FLOAT GROW;
   TITLE "FINAL RESULT FOR THE SHARE AND AMMOUNT OF EACH RELATIVE";
   FOOTER "DESIGNED BY: MUHAMMAD REHAN QADRI";
   FONT "MS SANS SERIF",8;
   COLOR RGB (,,255,192,192,192)
ACTIVATE WIND WARIS1
moreloop=.t.
set message to "Press Escape To Continue"
BROWS FIELDS NAME,RELATION,SHARE,AMMOUNT WINDOW WARIS1 TITLE "FINAL RESULT" NOEDIT NODELET FONT "TIMES NEW ROMAN",12 STYLE "BT" WIDTH 26 COLOR SCHEME 8 FOR RECNO=REC

DEAC WIND ALL
RELE WIND ALL
SET MESSAGE TO

DEFINE WINDOW WARIS1 AT 5,0 SIZE 30-14,125-4;
   SHADOW MINIMIZE FLOAT GROW;
   TITLE "USER RESPONSE";
   FOOTER "DESIGNED BY: MUHAMMAD REHAN QADRI";
   FONT "MS SANS SERIF",8;
   COLOR RGB (,,255,192,192,192);
   FILL FILE SYS(5)+SYS(2003)+"\back1.BMP"
ACTIVATE WIND WARIS1
MOVE WINDOW WARIS1 CENTER

@ 5,37 GET mchoice DEFAULT " " SIZE 2,1,2;
   FUNCTION "*HN \<SAVE;\<PRINT;\<DELETE;E\<XIT";
   FONT "MS SANS SERIF",9 STYLE "BT";
   VALID CHK_CHOICE()

READ

FUNCTION CHK_CHOICE

DO CASE

CASE mchoice="SAVE"
@ 10,40 SAY "RECORD IS SAVED" FONT "TIMES NEW ROMAN",14 STYLE "BT"
WAIT WINDOW "PRESS ANY KEY TO EXIT"
DEAC WIND ALL
RELE WIND ALL
CLOS ALL

CASE mchoice="PRINT"
do print
REPORT FORM INHERIT PREV FOR RECNO=REC   
REPORT FORM INHERIT TO PRINT PROMPT PREV FOR RECNO=REC   
DEAC WIND ALL
RELE WIND ALL
CLOS ALL

CASE mchoice="DELETE"
DELE FOR RECNO=REC
PACK
SELECT INH
DELE FOR RECNO=REC
PACK

@ 10,40 SAY "RECORD IS DELETED" FONT "TIMES NEW ROMAN",14 STYLE "BT"
WAIT WINDOW "PRESS ANY KEY TO EXIT"
DEAC WIND ALL
RELE WIND ALL
CLOS ALL

CASE MCHOICE="EXIT"
DEAC WIND ALL
RELE WIND ALL
CLOS ALL

ENDCASE
CLOS ALL
RETURN TO MASTER

PROCEDURE RAD

IF YNWIFE="N" AND YNHUSBAND="N"
MAKHRAJ=TOTAL
RETURN MAKHRAJ
ENDIF

IF YNWIFE="Y" OR YNHUSBAND="Y"
*THIRD CONDITION
LOCATE FOR RECNO=REC AND .NOT. (RELATION="WIFE" OR RELATION="HUSBAND")
MRELATION=RELATION
COUNT=0
RELCHECK=1
DO WHILE .NOT. EOF()
	CONTINUE	
	COUNT=COUNT+1
	NRELATION=RELATION
		IF MRELATION=NRELATION
			RELCHECK=1
		ELSE
			EXIT
		ENDIF
ENDDO		

IF RELCHECK=1
DO CASE
CASE M.SEX="MALE"
MAKHRAJ=8
CASE M.SEX="FEMALE"
MAKHRAJ=4
ENDCASE

IF COUNT/(MAKHRAJ-1)=0
REPLACE SHARE WITH 1 FOR (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
REPLACE SHARE WITH COUNT FOR .NOT. (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
ELSE
SHAREDAUGHT=MAKHRAJ-1

if count<makhraj-1
wafq=TAWAFUQ (count, (makhraj-1) )
else
WAFQ=TAWAFUQ ( (MAKHRAJ-1) ,COUNT)
ENDIF

IF WAFQ=1
MAKHRAJ=COUNT*MAKHRAJ
REPLACE SHARE WITH COUNT FOR (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
REPLACE SHARE WITH SHAREDAUGHT*COUNT FOR .NOT. (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
ELSE
MAKHRAJ=MAKHRAJ*WAFQ
REPLACE SHARE WITH WAFQ FOR (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
REPLACE SHARE WITH SHAREDAUGHT*(COUNT/WAFQ) FOR .NOT. (RELATION="WIFE" OR RELATION="HUSBAND" ) AND RECNO=REC ALL
ENDIF

ENDIF
RETURN MAKHRAJ
ENDIF
ENDIF


PROCEDURE TAWAFUQ
para no1,no2
ans=(no2%no1)
do while .not. ans=0
temp=no1
no1=ans
no2=temp
ans=(no2%no1)
enddo
return no1

