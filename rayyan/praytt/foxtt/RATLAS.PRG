CLEAR
DEAC WIND ALL
SET EXACT OFF
RELE WIND ALL
SET STAT BAR OFF
SET SAFETY OFF
ON ERROR DO ERRORHANDLER IN UTILITY
ON KEY LABEL ESCAPE DO GETOUT IN UTILITY
SET TALK OFF
SET CENTURY ON
SET BLINK OFF
SET DATE BRITISH
CLOSE ALL
CLEAR
USE loctest IN 0 ORDER TAG CITY
DO CASE
CASE choice=2
   CLEAR
   INPUT=SPACE(20)
   DO GETINPUT IN WINDOW
   @ 2,5 SAY "ENTER LOCATION NAME INITIALS: " FONT "ARIAL",12 STYLE "BT"
   @ 2,60 GET INPUT FONT "ARIAL",12 STYLE "B"
   READ
   RELE WIND W2

CASE choice=3
   CLEAR
   DO GETINPUT IN WINDOW
   @ 2,5 SAY "FROM SN#:" FONT "ARIAL",12 STYLE "BT";
      GET sn1 DEFA 1;
      FONT "ARIAL",12 STYLE "B"
   @ 4,5 SAY "TO SN#:   " FONT "ARIAL",12 STYLE "BT";
      GET sn2 DEFA 1;
      FONT "ARIAL",12 STYLE "B"
   READ
   RELE WIND W2
ENDCASE
DO DP IN WINDOW
RELE WIND W1
IF dp='P'
   DO PRINT IN RATLAS
ELSE
   DO DISP IN RATLAS
ENDIF

PROCEDURE DISP
DEAC WIND ALL
RELE WIND ALL
CLEAR
SET STAT BAR OFF
DEFINE WINDOW RATLAS AT 3,0 SIZE 30,115;
   NONE;
   GROW;
   FLOAT;
   ZOOM;
   CLOSE;
   MINIMIZE;
   TITLE "GEOGRAPHICAL DETAILS DISPLAY SHEET";
   FOOTER "***DESIGNED BY MUHAMMAD REHAN QADRI***";
   FONT "ARIAL",10


ACTIVATE WINDOW RATLAS
MOVE WINDOW RATLAS CENTER

IF CHOICE=1			&& COMPLETE DISPLAY
SELECT SN,UPPER(ALLTRIM(CITY)) AS CITY ,UPPER(ALLTRIM(COUNTRY)) AS COUNTRY,;
longitude+SUBSTR(lo_dir,1,1) AS LONGITUDE,;
latitude+SUBSTR(la_dir,1,1) AS LATITUDE,GREEN AS GMT,LEFT(SIGN,1)+DIFF AS TIME_ZONE;
FROM LOCTEST ORDER BY CITY INTO TABLE TEMP

BROWS FIELDS SN,CITY,COUNTRY,longitude,;
latitude,GMT,TIME_ZONE;
NOEDIT NODELE NOAPPEND
ENDIF

IF CHOICE=2			&& INDIVIDUAL DISPLAY
SELECT SN,UPPER(ALLTRIM(CITY)) AS CITY ,UPPER(ALLTRIM(COUNTRY)) AS COUNTRY,;
longitude+SUBSTR(lo_dir,1,1) AS LONGITUDE,;
latitude+SUBSTR(la_dir,1,1) AS LATITUDE,GREEN AS GMT,LEFT(SIGN,1)+DIFF AS TIME_ZONE;
WHERE CITY=UPPER(ALLTRIM(INPUT));
FROM LOCTEST ORDER BY CITY INTO TABLE TEMP

BROWS FIELDS SN,CITY,COUNTRY,longitude,;
latitude,GMT,TIME_ZONE;
FOR city=UPPER(ALLTRIM(INPUT));
NOEDIT NODELE NOAPPEND
ENDIF

IF CHOICE=3			&& DISPLAY B/W SERIAL NOS.
SELECT SN,UPPER(ALLTRIM(CITY)) AS CITY ,UPPER(ALLTRIM(COUNTRY)) AS COUNTRY,;
longitude+SUBSTR(lo_dir,1,1) AS LONGITUDE,;
latitude+SUBSTR(la_dir,1,1) AS LATITUDE,GREEN AS GMT,LEFT(SIGN,1)+DIFF AS TIME_ZONE;
WHERE SN>=SN1 AND SN<=SN2;
FROM LOCTEST ORDER BY SN INTO TABLE TEMP

BROWS FIELDS SN,CITY,COUNTRY,longitude,;
latitude,GMT,TIME_ZONE;
FOR BETWEEN(sn,sn1,sn2);
NOEDIT NODELE NOAPPEND
ENDIF
CLEAR
DEAC WIND RATLAS
RELEASE WINDOW RATLAS
RELEASE WINDOW w1
CLOS ALL
SET EXACT ON
RETURN

PROCEDURE PRINT

IF CHOICE=1			&& COMPLETE DISPLAY
REPORT FORM RATLAS TO PRINT PROMPT
ENDIF

IF CHOICE=2			&& INDIVIDUAL DISPLAY
REPORT FORM RATLAS FOR CITY=UPPER(ALLTRIM(INPUT)) TO PRINT PROMPT
ENDIF

IF CHOICE=3			&& DISPLAY B/W SERIAL NOS.
REPORT FORM RATLAS FOR BETWEEN (SN,SN1,SN2) TO PRINT PROMPT
ENDIF

CLEAR
DEAC WIND RATLAS
RELEASE WINDOW RATLAS
RELEASE WINDOW w1
CLOS ALL
SET EXACT ON
RETURN
